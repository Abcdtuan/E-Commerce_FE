<div class="login-container">
    <mat-card>
        <mat-card-title>Quên mật khẩu</mat-card-title>
        <mat-card-content>
            
            
            <form *ngIf="step === 1">
                <mat-form-field appearance="outline" floatLabel="auto">
                    <mat-label>Email của bạn</mat-label>
                    <input 
                        matInput 
                        type="email" 
                        [(ngModel)]="email" 
                        name="email"
                        placeholder="Nhập email đã đăng ký" 
                        required 
                    />
                    <mat-error *ngIf="!email">
                        Vui lòng nhập email.
                    </mat-error>
                </mat-form-field>

                <button 
                    mat-raised-button 
                    color="primary" 
                    type="button"
                    (click)="sendOtp()" 
                    [disabled]="!email"
                >
                    Gửi mã OTP
                </button>
            </form>

            
            <form *ngIf="step === 2">
                <p class="info-text">
                    Mã OTP đã được gửi tới: <strong>{{ email }}</strong>
                </p>

                <mat-form-field appearance="outline" floatLabel="auto">
                    <mat-label>Nhập mã OTP</mat-label>
                    <input 
                        matInput 
                        type="text" 
                        [(ngModel)]="otp" 
                        name="otp"
                        placeholder="Nhập mã OTP" 
                        required 
                    />
                    <mat-error *ngIf="!otp">
                        Vui lòng nhập mã OTP.
                    </mat-error>
                </mat-form-field>

                <div class="btn-group">
                    <button 
                        mat-stroked-button 
                        color="warn" 
                        type="button"
                        (click)="step = 1"
                    >
                        Quay lại
                    </button>
                    <button 
                        mat-raised-button 
                        color="primary" 
                        type="button"
                        (click)="verifyOtp()" 
                        [disabled]="!otp"
                    >
                        Xác minh OTP
                    </button>
                </div>
            </form>

            <!-- Bước 3: Đặt mật khẩu mới -->
            <form *ngIf="step === 3">
                <mat-form-field appearance="outline" floatLabel="auto">
                    <mat-label>Mật khẩu mới</mat-label>
                    <input 
                        matInput 
                        [type]="hidePassword ? 'password' : 'text'"
                        [(ngModel)]="newPassword" 
                        name="newPassword"
                        placeholder="Nhập mật khẩu mới" 
                        required 
                    />
                    <button 
                        mat-icon-button 
                        matSuffix 
                        (click)="togglePasswordVisibility()" 
                        type="button"
                    >
                        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                    <mat-error *ngIf="!newPassword">
                        Vui lòng nhập mật khẩu mới.
                    </mat-error>
                </mat-form-field>

                <div class="btn-group">
                    <button 
                        mat-stroked-button 
                        color="warn" 
                        type="button"
                        (click)="step = 2"
                    >
                        Quay lại
                    </button>
                    <button 
                        mat-raised-button 
                        color="accent" 
                        type="button"
                        (click)="resetPassword()" 
                        [disabled]="!newPassword"
                    >
                        Đặt lại mật khẩu
                    </button>
                </div>
            </form>
        </mat-card-content>

        <mat-card-actions>
            <button mat-button color="accent" routerLink="/login">
                Quay lại đăng nhập
            </button>
        </mat-card-actions>
    </mat-card>
</div>